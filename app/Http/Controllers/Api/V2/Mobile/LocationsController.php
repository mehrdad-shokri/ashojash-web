<?php

namespace App\Http\Controllers\Api\V2\Mobile;

use App\Http\Controllers\Api\v2\BaseController;
use Illuminate\Support\Facades\DB;

class LocationsController extends BaseController {

	public function temp()
	{

//		DB::statement("ST_GeomFromText('POINT(-72.1235 42.3521)',4326)");
		DB::statement("SET @mbr= ST_ENVELOPE(ST_GeomFromText('LINESTRING(45.0479848 37.5311131, 45.0479958 37.5312231, 45.0482483 37.531721, 45.0483277 37.5318777, 45.04847 37.5321809, 45.0488327 37.5327735, 45.0492823 37.5334467, 45.0496518 37.534, 45.0498882 37.534354, 45.0501035 37.5346404, 45.0502517 37.5348355, 45.0504628 37.5350571, 45.0507101 37.5352561, 45.0511833 37.5356229, 45.0516779 37.5360064, 45.0517959 37.5360853, 45.0519226 37.5361549, 45.0521995 37.5362683, 45.0525157 37.5363561, 45.0530062 37.5364685, 45.0537182 37.5366317, 45.0539876 37.5366793, 45.0542621 37.536716, 45.0556538 37.5369289, 45.0557011 37.5370457)'))");
		DB::statement("SET @mbr= POLYGON");

		dd(DB::select("SELECT ST_DISTANCE(ST_GeomFromText('POINT(45.044927 37.535166)'),ST_GeomFromText('LINESTRING(45.0479848 37.5311131, 45.0479958 37.5312231, 45.0482483 37.531721, 45.0483277 37.5318777, 45.04847 37.5321809, 45.0488327 37.5327735, 45.0492823 37.5334467, 45.0496518 37.534, 45.0498882 37.534354, 45.0501035 37.5346404, 45.0502517 37.5348355, 45.0504628 37.5350571, 45.0507101 37.5352561, 45.0511833 37.5356229, 45.0516779 37.5360064, 45.0517959 37.5360853, 45.0519226 37.5361549, 45.0521995 37.5362683, 45.0525157 37.5363561, 45.0530062 37.5364685, 45.0537182 37.5366317, 45.0539876 37.5366793, 45.0542621 37.536716, 45.0556538 37.5369289, 45.0557011 37.5370457)'));"));
		dd(DB::select("SELECT ST_astext(@mbr);"));
		dd(DB::select("SELECT ST_WITHIN(ST_GeomFromText('POINT(45.049203 37.536713)'),@mbr);"));

	}

	public function temp2()
	{

		DB::statement("SET @line = ST_GeomFromText('LINESTRING(45.0557011 37.5370457, 45.0555661 37.5369954, 45.0542435 37.5367979, 45.0539412 37.5367563, 45.0536922 37.5367123, 45.0524838 37.5364353, 45.0521579 37.5363448, 45.0518759 37.5362295, 45.0517321 37.5361514, 45.0516074 37.5360679, 45.0514928 37.5359791, 45.0506361 37.5353149, 45.0503833 37.5351116, 45.050165 37.5348825, 45.0500171 37.5346927, 45.0499761 37.53464, 45.0497965 37.5343944, 45.0494391 37.5338592, 45.0491492 37.533425, 45.0487392 37.5328111, 45.0483734 37.5322136, 45.0482313 37.5319033, 45.0481431 37.5317106, 45.0479496 37.5313365, 45.0478737 37.5311899, 45.0479848 37.5311131)');");
		DB::statement("SET @pt = ST_GeomFromText('POINT(45.062481 37.545934)');");
		DB::statement("SET @buffer=st_buffer(@line,0.000000001)");

		dd(DB::select("SELECT ST_distance(@buffer,@pt)"));
		dd(DB::select("SELECT ST_CONTAINS(@buffer,@pt)"));
		dd(DB::select("SELECT ST_CONTAINS(@buffer,@pt)"));
	}
}
