{"version":3,"sources":["review.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"review.js","sourcesContent":["$(document).ready(function () {\r\n    var priceHolder = 0;\r\n    var qualityHolder = 0;\r\n    var decorHolder = 0;\r\n\r\n    $(function () {\r\n        $(\"#cost-rating\").barrating({\r\n            theme: 'bars-1to10',\r\n            showSelectedRating: true,\r\n            fastClicks: true,\r\n            wrapperClass: \"br-wrapper\",\r\n            onSelect: function (value, text) {\r\n                priceHolder = value;\r\n            }\r\n        });\r\n        $(\"#quality-rating\").barrating({\r\n            theme: 'bars-1to10',\r\n            showSelectedRating: true,\r\n            fastClicks: true,\r\n            wrapperClass: \"br-wrapper\",\r\n            onSelect: function (value, text) {\r\n                qualityHolder = value;\r\n            }\r\n        });\r\n        $(\"#decor-rating\").barrating({\r\n            theme: 'bars-1to10',\r\n            showSelectedRating: true,\r\n            fastClicks: true,\r\n            wrapperClass: \"br-wrapper\",\r\n            onSelect: function (value, text) {\r\n                decorHolder = value;\r\n            }\r\n        });\r\n        $(\".br-current-rating\").css(\"width\", \"150px\").css(\"color\", \"#9E9E9E\").css(\"font-size\", \"15px\").css(\"font-weight\", \"bold\");\r\n    });\r\n\r\n\r\n    $(\"#js-trigger-review\").on(\"click\", function () {\r\n        $(this).removeClass(\"hand\");\r\n        $(\"#review-hint\").addClass(\"hidden\");\r\n        $(\"#review-section\").fadeIn().removeClass(\"hidden\");\r\n        return true;\r\n        //bring review section\r\n    });\r\n    $(\"#upload-photo-section\").click(function () {\r\n        $(this).fadeOut().addClass(\"hidden\");\r\n        $(\"#upload-photo-method\").fadeIn().removeClass(\"hidden\");\r\n        return false;\r\n    });\r\n\r\n    $(\"#uploadInstagram\").on(\"click\", function () {\r\n        //open instagram\r\n        return false;\r\n    });\r\n\r\n    $(\"#cancel-review\").on(\"click\", function (e) {\r\n        returnDefaultState();\r\n        return false;\r\n    });\r\n    $(\"#publish-btn\").on(\"click\", function () {\r\n        var reviewText = $(\"#review-text\");\r\n        var length = reviewText.val().length;\r\n        if (length < 70) {\r\n            swal({\r\n                title: \"توجه\",\r\n                text: \"مرور شما حداقل باید 70 کاراکتر باشد\",\r\n                type: \"info\",\r\n                confirmButtonText: 'باشه',\r\n                showConfirmButton: true\r\n            });\r\n        }\r\n        else if (priceHolder == 0 || qualityHolder == 0 || decorHolder == 0)\r\n            swal({\r\n                title: \"توجه\",\r\n                text: \"فیلدهای ارزیابی الزامی است\",\r\n                type: \"info\",\r\n                confirmButtonText: 'باشه',\r\n                showConfirmButton: true\r\n            });\r\n        else\r\n            sendPublishReviewRequest();\r\n        return false;\r\n    });\r\n    function sendPublishReviewRequest() {\r\n        var venueSlug = $(\"#venueSlug\").val();\r\n        var review_text = $(\"#review-text\").val();\r\n        var objectData = {\r\n            \"review-text\": review_text,\r\n            \"decor\": decorHolder,\r\n            \"cost\": priceHolder,\r\n            \"quality\": qualityHolder,\r\n            \"venueSlug\": venueSlug\r\n        };\r\n        var objectDataString = JSON.stringify(objectData);\r\n        $.ajax(\"/user/review/add\", {\r\n            headers: {\r\n                'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\r\n            },\r\n            beforeSend: function () {\r\n\r\n            },\r\n            dataType: \"json\",\r\n            data: {\r\n                data: objectDataString\r\n            },\r\n            success: function (data) {\r\n                swal({\r\n                    title: \"پایان\",\r\n                    text: \"مرور شما با موفقیت ثبت شد\",\r\n                    type: \"success\",\r\n                    timer: 2000,\r\n                    showConfirmButton: false\r\n                });\r\n                returnDefaultState();\r\n            },\r\n            error: function (e) {\r\n                //show error\r\n                console.log(e.status);\r\n                if (e.status == 429)\r\n                    swal({\r\n                        title: \"خطا\",\r\n                        text: \"ببخشید، برای هر مکان در طول هفته،‌ تنها یک مرور می توانید بنویسید!\",\r\n                        type: \"error\",\r\n                        confirmButtonText: 'باشه',\r\n                        showConfirmButton: true\r\n                    });\r\n                else\r\n                    swal({\r\n                        title: \"خطا\",\r\n                        text: \"خطایی در ثبت مرور رخ داد دوباره امتحان کنید\",\r\n                        type: \"error\",\r\n                        confirmButtonText: 'باشه',\r\n                        showConfirmButton: true\r\n                    });\r\n                returnDefaultState();\r\n            },\r\n            type: \"POST\"\r\n        });\r\n    }\r\n\r\n    function returnDefaultState() {\r\n        $(\"#js-trigger-review\").addClass(\"hand\");\r\n        $(\"#review-section\").fadeOut();\r\n        $(\"#review-section\").addClass(\"hidden\");\r\n        $(\"#review-hint\").removeClass(\"hidden\");\r\n    }\r\n\r\n    /*function barRating(id, valueHolder) {\r\n     $(\"#\" + id).barrating({\r\n     theme: 'bars-1to10',\r\n     showSelectedRating: true,\r\n     fastClicks: true,\r\n     initialRating: 3,\r\n     wrapperClass: \"br-wrapper\",\r\n     onSelect: function (value, text) {\r\n     priceHolder = value;\r\n     }\r\n     });\r\n     }*/\r\n});\r\n"],"sourceRoot":"/source/"}